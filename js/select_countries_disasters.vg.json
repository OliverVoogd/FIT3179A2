{
	"$schema": "https://vega.github.io/schema/vega-lite/v5.json",
	"title": "Disasters by Country 1980-2018",
	"data": {
		"url": "https://raw.githubusercontent.com/OliverVoogd/FIT3179A2/master/data/emdat_trimmed_joined_sedac_datefixed.csv"
	},
	"params":[
		{
			"name": "CountrySelect",
			"value": ["Australia", "England", "Japan", "China", "India", "Indonesia", "Chile", "Turkey"]
		}
	],
	"hconcat": [
		{
			"height": "container",
			"width": 400,
			"projection": {"type": "equalEarth"},
			"data": {
				"url": "https://raw.githubusercontent.com/OliverVoogd/FIT3179A2/master/data/countries.topo.json",
				"format": {"type":"topojson", "feature":"ne_50m_admin_0_countries"}
			},
			"transform": [
				{
					"lookup": "properties.NAME",
					"from": {
						"data": {
							"url": "https://raw.githubusercontent.com/OliverVoogd/FIT3179A2/master/data/emdat_trimmed_joined_sedac_datefixed_choropleth.csv"
						},
						"key": "country",
						"fields": ["deathsCumulative"]
					}
				}
			],
			"mark": {"type":"geoshape"},
			"encoding": {
				"color": {
					"field": "DeathsCumulative",
					"type": "quantitative",
					"scale": {"type": "linear"}
				},
				"tooltip": [
					{"field": "properties.NAME", "type": "nominal", "title": "Country"},
					{"field": "DeathsCumulative", "type": "quantitative", "title": "Deaths"}
				]
			}
			
		},
		{
			"height": "container",
			"width": 400,
			"layer": [
				{
					"transform": [
						{"filter": "datum.year >= 1980"},
						{"filter": "indexof(CountrySelect, datum.country) >= 0"}
					],
					"mark": "bar",
					"encoding": {
						"x": {
							"field": "country", 
							"type": "nominal",
							"axis": {
								"labelAngle": 0
							},
							"title": "Country"
						},
						"y": {"aggregate": "count", "type": "quantitative", "title": "Disaster per Country"},
						"color": {
							"field": "disastertype",
							"type": "nominal",
							"scale": {"scheme": "dark2"},
							"legend": null
						}
					}
				}
			]
		}
	],
	"config": {
		"concat": {
			"spacing": 50
		}
	}
}